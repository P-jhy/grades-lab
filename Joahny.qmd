---
title: "JOAHNY"
author: "Paul Joahny"
format: html
---
#Github link repository 
https://github.com/P-jhy/grades-lab.git

#Question 1
```{r}
library(here)
library(readr)
library(vroom)
here::i_am("grades-lab.Rproj")

courses <- vroom(here("Data", "courses.csv"))

```

#Question 2

```{r}

library(dplyr)
library(knitr)

courses |>
  arrange(course) |>
  rename(
    "course name" = course,
    "identifier" = course_id,
    "semester" = semester,
    "number of exams" = nb_grades
  ) |>
  kable()

```
#Question 3
```{r}


students <- vroom(
  here("Data", "students.csv"),
  col_types = cols(
    id = col_integer(),
    group = col_factor(),
    birth_date = col_date(),
    sex = col_factor()
  )
)
spec(students)

```
#Question 4
```{r}


grades <- read_delim(
  here("Data", "grades.csv"),
  delim = "|",
  na = "$",
  col_types = cols(
    id = col_integer(),
    course_id = col_integer(),
    grade = col_double()
  )
)


```

#Question 5
```{r}
library(ggplot2)

ggplot(students, aes(x = group)) +
  geom_bar()


```
#Question 6
```{r}
ggplot(students, aes(x = group, fill = sex)) +
  geom_bar(position = "fill")
```

#Question 7
First calculate age 
```{r}
library(lubridate)
library(dplyr)

students <- students |>
  mutate(age = time_length(today() - birth_date, unit = "year"))
```
```{r}
ggplot(students, aes(x = age)) +
  geom_density(bw = "sj") +
  geom_rug(alpha = 0.1)
```

#Question 8 

```{r}

median_age <- students |>
  summarise(
    median_age = round(median(age)),
    .by = group
  )

median_age |> kable()
```
#Question 9 
```{r}
library(dplyr)
library(knitr)
oldest <- students |>
  slice_max(age, n = 1, by = group) |>
  select(id, sex, age, group) |>
  arrange(desc(age))

oldest |> kable()
```

#Question 10 

```{r}

grade_count <- grades |>
  filter(!is.na(grade)) |>
  nrow()

```

The data set contains `r grade_count` grades.


#Question 11

```{r}


roman_avg <- grades |>
  inner_join(courses, by = "course_id") |>
  filter(course == "Roman Law and Jurisprudence") |>
  inner_join(students, by = "id") |>
  summarise(
    avg_grade = mean(grade, na.rm = TRUE),
    .by = group
  )
```

```{r}

ggplot(roman_avg, aes(x = group, y = avg_grade)) +
  geom_col()

```

#Question 12
```{r}

grades_sem <- grades |>
  inner_join(courses, by = "course_id") |>
  filter(!is.na(grade))

ggplot(grades_sem, aes(x = grade)) +
  geom_density(bw = "sj") +
  geom_rug(alpha = 0.1) +
  facet_wrap(vars(semester))

```

```{r}

library(dplyr)

grades_sem_count <- grades |>
  inner_join(courses, by = "course_id") |>
  filter(!is.na(grade)) |>
  summarise(
    n = n(),
    .by = semester
  )

grades_sem_count

```

#Question 13
```{r}
grades_per_student <- grades |>
  filter(!is.na(grade)) |>
  summarise(
    n_grades = n(),
    .by = id
  ) |>
  inner_join(students, by = "id") |>
  select(id, sex, group, n_grades)

grades_per_student |>
  slice_head(n = 5) |>
  knitr::kable()

stats <- grades_per_student |>
  summarise(
    min = min(n_grades),
    max = max(n_grades),
    mean = mean(n_grades),
    median = median(n_grades)
  )

```

The number of grades per student ranges from `r stats$min` to `r stats$max`.

| statistic | value |
|----------|-------|
| minimum  | `r stats$min` |
| maximum  | `r stats$max` |
| average  | `r round(stats$mean, 2)` |
| median   | `r stats$median` |

#Question 14
```{r}

ggplot(grades_per_student, aes(x = n_grades)) +
  geom_histogram(bins = 20) +
  facet_wrap(vars(sex))

```


```{r}

ggplot(grades_per_student, aes(x = n_grades, fill = sex)) +
  geom_histogram(position = "identity", alpha = 0.5, bins = 20)

```
I feel like having two seperate graphs is cleared but just in case i put an other one with both M and F on the same graphic.


#Question 15
```{r}

philo_grades <- grades |>
  inner_join(courses, by = "course_id") |>
  filter(course == "Philosophy and Logic") |>
  summarise(
    n_grades = n(),
    .by = id
  ) |>
  inner_join(students, by = "id") |>
  select(id, group, sex, n_grades)

philo_grades |>
  slice_head(n = 5) |>
  kable()


```

Other table to show that 10 is quite common ( but thats pretty much question 16 also)
```{r}
philo_grades |>
  summarise(
    min = min(n_grades),
    max = max(n_grades),
    mean = mean(n_grades),
    median = median(n_grades)
  )
```


#Question 16 


```{r}

philo_dist <- philo_grades |>
  summarise(
    n_students = n(),
    .by = n_grades
  )

ggplot(philo_dist, aes(x = n_grades, y = n_students)) +
  geom_col()

```

#Question 17 

```{r}
ggplot(philo_grades, aes(x = group, y = n_grades)) +
  geom_violin()
```

#Question 18
`
```{r}
ggplot(philo_grades, aes(x = group, y = n_grades)) +
  geom_boxplot() +
  facet_wrap(vars(sex))
```
